This summary was generated by chatGPT and reviewed by Dafydd Roche for accuracy.
Much of the code and tooling was architected and tested by Dafydd Roche, but coded by chatGPT.

---

# CYD Video Player (TerrainTronics)

A simple, reliable MJPEG video player firmware for **CYD ESP32 display boards**, designed for looping ambient visuals such as fireplaces, portals, fog, and animated scenery.

This project focuses on **ease of use**:

* No menus
* No configuration files
* Copy videos to an SD card and power on

---

## Features

* Automatic playback of `.mjpeg` files from SD card
* Single-button control (BOOT button)
* Persistent display color inversion
* Designed for 4:3 displays (320Ã—240)
* Stable 12â€“15 FPS playback
* Predictable power consumption (~150 mA @ 5 V)

---

## Hardware Requirements

* CYD board (ESP32-2432S028R or compatible)
* microSD card (FAT32)
* 5 V USB power source

---

## Firmware Download

Pre-built firmware packages and installer files are available here:

ðŸ‘‰ **[https://links.terraintronics.com/ttinstall](https://links.terraintronics.com/ttinstall)**

Scroll to the **Prototype Area** at the bottom of the page to download the latest CYD Video Player release.

---

## How It Works

1. On boot, the firmware scans the SD card for `.mjpeg` files
2. Videos are played full screen in sequence
3. When the last file finishes, playback loops back to the first

> âš ï¸ The ESP32 does **not** decode MP4 or H.264 video directly.
> All content must be converted to **MJPEG**.

---

## Video Conversion (MP4 â†’ MJPEG)

### Browser-Based Converter (Recommended)

TerrainTronics provides a free, browser-based conversion tool:

ðŸŽ¬ **[https://links.terraintronics.com/cydconvert](https://links.terraintronics.com/cydconvert)**

* Runs entirely in your browser
* Uses FFmpeg (WebAssembly)
* No uploads, no accounts, no installs

**Workflow:**

1. Select an MP4 file
2. Choose an output name
3. Convert
4. Download the `.mjpeg` file
5. Copy it to an `mjpeg` folder on your SD card

---

## Aspect Ratio (Important)

The CYD display is **4:3 (320Ã—240)**.

Most modern video is **16:9**, which means:

* Direct conversion will produce **letterboxed** videos
* Black bars reduce effective screen usage

### Best Practice (Strongly Recommended)

For best results:

1. Open your video in a video editor (DaVinci Resolve, Premiere, Shotcut, etc.)
2. Set the project to **4:3**
3. Pan and crop the video to frame the action
4. Export as MP4
5. Convert the edited MP4 using the browser tool

This produces sharper, full-screen results with no black bars.

---

## Frame Rate Expectations

* Typical playback: **12â€“15 FPS**
* This is normal and expected
* Best suited for:

  * Ambient loops
  * Fireplaces
  * Magical portals
  * Fog and energy effects

Fast action or high-motion video is not recommended.

---

## SD Card Layout

Recommended structure:

```
SDCARD/
â”œâ”€â”€ mjpeg/
â”‚   â”œâ”€â”€ fireplace.mjpeg
â”‚   â”œâ”€â”€ portal.mjpeg
â”‚   â””â”€â”€ fog.mjpeg
```

Notes:

* Use short filenames
* Avoid spaces and special characters
* Format SD cards as FAT32

---

## BOOT Button Behavior

The BOOT button acts as the **entire user interface**.

### Short Press â€” Next Video

* Stops the current video
* Advances to the next `.mjpeg` file
* Wraps back to the first file after the last

### Long Press (~5 seconds) â€” Display Inversion

* Toggles display color inversion
* Setting is saved to non-volatile memory
* Automatically restored on power-up

This exists because CYD displays vary between batches.

### Power-Up Sequence

1. Screen starts black
2. Splash screen displays
   `terraintronics.com`
   (rotated 90Â° clockwise)
3. Splash remains for ~5 seconds
4. Video playback begins automatically

---

## Power Consumption & Battery Planning

During active video playback, the board draws approximately:

**~150 mA @ 5 V**

This includes:

* ESP32 processing
* SD card access
* LCD backlight
* MJPEG decoding

### Runtime Estimates

| Battery  | Approx. Runtime |
| -------- | --------------- |
| 500 mAh  | ~3 hours        |
| 1000 mAh | ~6 hours        |
| 2000 mAh | ~12 hours       |

> Video playback is a **continuous load**, not burst-based.
> Always allow margin when sizing batteries.

---

## Known Limitations (By Design)

* No audio playback
* No MP4/H.264 decoding on device
* Fixed resolution and aspect ratio
* Frame rate intentionally limited

These trade-offs provide:

* Simple setup
* Reliable looping playback
* Predictable power usage

---

## Credits & Attribution

This project is **based on and derived from** the original MJPEG CYD playback work by:

**The Last Output Workshop** 

https://github.com/thelastoutpostworkshop/esp32-2432S028_video_player

TerrainTronics has:

* Adapted and extended the code
* Added persistent settings
* Improved usability
* Provided tooling, documentation, and distribution

The original author retains full credit for the foundational implementation.

---

## License

This project is released under the **MIT License**.

You are free to:

* Use
* Modify
* Distribute
* Incorporate into commercial or non-commercial projects - providing they also have the MIT license
  

See the `LICENSE` file for full terms.

---

## Links

* Firmware & tools:
  [https://links.terraintronics.com](https://links.terraintronics.com)
* Video converter:
  [https://links.terraintronics.com/cydconvert](https://links.terraintronics.com/cydconvert)
* TerrainTronics:
  [https://terraintronics.com](https://terraintronics.com)

